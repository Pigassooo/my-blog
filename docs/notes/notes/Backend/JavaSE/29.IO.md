# 29. IO

![alt text](image-140.png)

- I指input，称为输入流：负责把数据读到内存中区
- O指output，称为输出流：负责把数据从内存中区写出到磁盘或网络中

![alt text](image-148.png)

流的四大类：
    - 字节输入流：以内存为基准，来自磁盘文件/网络中的数据以字节的形式读入到内存中去的流
    - 字节输出流：以内存为基准，将内存中的数据以字节的形式写出到磁盘文件/网络中的流
    - 字符输入流：以内存为基准，来自磁盘文件/网络中的数据以字符的形式读入到内存中去的流
    - 字符输出流：以内存为基准，将内存中的数据以字符的形式写出到磁盘文件/网络介质中的流


![alt text](image-149.png)

## IO流-字节流

### FileInputStream 字节输入流

- 以内存为基准，来自磁盘文件/网络中的数据以字节的形式读入到内存中去

![alt text](image-150.png)

![alt text](image-151.png)

- 注意事项：
    - 使用```FileInputStream.read()```每次读取一个字节，读取性能较差(调用硬件资源多，效率低)，并且读汉字时候会出现乱码(utf-8编码中汉字占3个字节)。
    - 使用```FileInputStream.read(byte[] b)```一次性读取多个字节，效率较高，但是一次性读取的字节数不能超过数组的长度，读汉字时候还是会出现乱码。
    - 流使用完毕之后，必须关闭，释放资源。```file.close()```

- 一次性读取完全部字节：
（如果文件很大，一次性读取会导致内存溢出）
![alt text](image-152.png)

- 读写文本内容更适合用字符流
- 字节流适合做数据的转移，如：文件复制、文件传输等

### FileOutputStream 字节输出流

- 字节输出流：以内存为基准，将内存中的数据以字节的形式写出到磁盘文件/网络中

![alt text](image-153.png)

- 注意事项：
    - os先关闭，再关闭is

## 释放资源的方式

### try-catch-finally

```java
try {
    // 代码块
} catch (Exception e) {
    // 异常处理
} finally {
    // 释放资源
}
```

- finally块特点: 无论try中的程序是正常执行还是出现了异常，最后一定会执行，除非JVM终止
- finally块作用：一般用于在程序执行完成后进行资源的释放操作(专业级做法)

![alt text](image-154.png)
![alt text](image-155.png)

### try-with-resources

![alt text](image-156.png)

```java
try(定义资源1，定义资源2...){
    // 可能出现异常的代码
}catch(异常类型 变量名){
    // 异常处理的代码
}
```
- 此处try中定义的资源，会在try块执行完毕后自动调用其close()方法，释放资源
- 资源的定义：都是会实现AutoCloseable接口的对象，如：InputStream、OutputStream等

![alt text](image-157.png)